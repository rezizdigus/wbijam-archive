!function(s){s.fn.lightbox=function(e){var o=s.extend({},s.fn.lightbox.defaults,e);return this.each(function(){s(this).click(function(){return function(){if(s("#overlay").remove(),s("#lightbox").remove(),o.inprogress=!1,o.jsonData&&0<o.jsonData.length){var e=o.jsonDataParser?o.jsonDataParser:s.fn.lightbox.parseJsonData;o.imageArray=[],o.imageArray=e(o.jsonData)}var i,a='<div id="outerImageContainer"><div id="imageContainer"><iframe id="lightboxIframe" /><img id="lightboxImage"><div id="hoverNav"><a href="javascript://" title="'+o.strings.prevLinkTitle+'" id="prevLink"></a><a href="javascript://" id="nextLink" title="'+o.strings.nextLinkTitle+'"></a></div><div id="loading"><a href="javascript://" id="loadingLink"><img src="'+o.fileLoadingImage+'"></a></div></div></div>',t='<div id="imageDataContainer" class="clearfix"><div id="imageData"><div id="imageDetails"><span id="caption"></span><span id="numberDisplay"></span></div><div id="bottomNav">';o.displayHelp&&(t+='<span id="helpDisplay">'+o.strings.help+"</span>");t+='<a href="javascript://" id="bottomNavClose" title="'+o.strings.closeTitle+'"><img src="'+o.fileBottomNavCloseImage+'"></a></div></div></div>',o.navbarOnTop?(i='<div id="overlay"></div><div id="lightbox">'+t+a+"</div>",s("body").append(i),s("#imageDataContainer").addClass("ontop")):(i='<div id="overlay"></div><div id="lightbox">'+a+t+"</div>",s("body").append(i));s("#overlay").click(function(){r()}).hide(),s("#lightbox").click(function(){r()}).hide(),s("#loadingLink").click(function(){return r(),!1}),s("#bottomNavClose").click(function(){return r(),!1}),s("#outerImageContainer").width(o.widthCurrent).height(o.heightCurrent),s("#imageDataContainer").width(o.widthCurrent),o.imageClickClose||(s("#lightboxImage").click(function(){return!1}),s("#hoverNav").click(function(){return!1}))}(),function(e){s("select, embed, object").hide();var a=g();s("#overlay").hide().css({width:"100%",height:a[1]+"px",opacity:o.overlayOpacity}).fadeIn(),imageNum=0,o.jsonData||(o.imageArray=[],e.rel&&""!=e.rel?s("a").each(function(){this.href&&this.rel==e.rel&&o.imageArray.push(new Array(this.href,o.displayTitle?this.title:""))}):o.imageArray.push(new Array(e.href,o.displayTitle?e.title:"")));if(1<o.imageArray.length){for(i=0;i<o.imageArray.length;i++)for(j=o.imageArray.length-1;j>i;j--)o.imageArray[i][0]==o.imageArray[j][0]&&o.imageArray.splice(j,1);for(;o.imageArray[imageNum][0]!=e.href;)imageNum++}var t=function(){var e,i;self.pageYOffset?(i=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(i=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(i=document.body.scrollTop,e=document.body.scrollLeft);return new Array(e,i)}(),r=t[1]+a[3]/10,n=t[0];s("#lightbox").css({top:r+"px",left:n+"px"}).show(),o.slideNavBar||s("#imageData").hide();l(imageNum)}(this),!1})});function g(){return new Array(s(document).width(),s(document).height(),s(window).width(),s(window).height())}function n(e){for(var i=new Date;new Date-i<e;);}function l(e){0==o.inprogress&&(o.inprogress=!0,o.activeImage=e,s("#loading").show(),s("#lightboxImage").hide(),s("#hoverNav").hide(),s("#prevLink").hide(),s("#nextLink").hide(),o.slideNavBar&&(s("#imageDataContainer").hide(),s("#imageData").hide()),a())}function a(){imgPreloader=new Image,imgPreloader.onload=function(){var e=imgPreloader.width,i=imgPreloader.height;if(o.fitToScreen){var a=g(),t=a[2]-2*o.borderSize,r=a[3]-200;imgPreloader.height>r?(e=parseInt(r/imgPreloader.height*imgPreloader.width),i=r):imgPreloader.width>t&&(i=parseInt(t/imgPreloader.width*imgPreloader.height),e=t)}s("#lightboxImage").attr("src",o.imageArray[o.activeImage][0]).width(e).height(i),function(e,i){o.widthCurrent=s("#outerImageContainer").outerWidth(),o.heightCurrent=s("#outerImageContainer").outerHeight();var a=Math.max(350,e+2*o.borderSize),t=i+2*o.borderSize;o.xScale=a/o.widthCurrent*100,o.yScale=t/o.heightCurrent*100,wDiff=o.widthCurrent-a,hDiff=o.heightCurrent-t,s("#imageDataContainer").animate({width:a},o.resizeSpeed,"linear"),s("#outerImageContainer").animate({width:a},o.resizeSpeed,"linear",function(){s("#outerImageContainer").animate({height:t},o.resizeSpeed,"linear",function(){s("#loading").hide(),s("#lightboxImage").fadeIn("fast"),function(){var e;s("#numberDisplay").html(""),o.imageArray[o.activeImage][1]&&s("#caption").html(o.imageArray[o.activeImage][1]).show(),1<o.imageArray.length&&(e=o.strings.image+(o.activeImage+1)+o.strings.of+o.imageArray.length,o.disableNavbarLinks||((0<o.activeImage||o.loopImages)&&(e='<a title="'+o.strings.prevLinkTitle+'" href="#" id="prevLinkText">'+o.strings.prevLinkText+"</a>"+e),(o.activeImage+1<o.imageArray.length||o.loopImages)&&(e+='<a title="'+o.strings.nextLinkTitle+'" href="#" id="nextLinkText">'+o.strings.nextLinkText+"</a>")),s("#numberDisplay").html(e).show()),o.slideNavBar?s("#imageData").slideDown(o.navBarSlideSpeed):s("#imageData").show();var i=g();s("#overlay").height(i[1]),1<o.imageArray.length&&(s("#hoverNav").show(),o.loopImages?(s("#prevLink,#prevLinkText").show().click(function(){return l(0==o.activeImage?o.imageArray.length-1:o.activeImage-1),!1}),s("#nextLink,#nextLinkText").show().click(function(){return l(o.activeImage==o.imageArray.length-1?0:o.activeImage+1),!1})):(0!=o.activeImage&&s("#prevLink,#prevLinkText").show().click(function(){return l(o.activeImage-1),!1}),o.activeImage!=o.imageArray.length-1&&s("#nextLink,#nextLinkText").show().click(function(){return l(o.activeImage+1),!1})),s(document).bind("keydown",{opts:o},m))}(),o.loopImages&&1<o.imageArray.length?(preloadNextImage=new Image,preloadNextImage.src=o.imageArray[o.activeImage==o.imageArray.length-1?0:o.activeImage+1][0],preloadPrevImage=new Image,preloadPrevImage.src=o.imageArray[0==o.activeImage?o.imageArray.length-1:o.activeImage-1][0]):(o.imageArray.length-1>o.activeImage&&(preloadNextImage=new Image,preloadNextImage.src=o.imageArray[o.activeImage+1][0]),0<o.activeImage&&(preloadPrevImage=new Image,preloadPrevImage.src=o.imageArray[o.activeImage-1][0])),o.inprogress=!1})}),0==hDiff&&0==wDiff&&(jQuery.browser.msie?n(250):n(100));s("#prevLink").height(i),s("#nextLink").height(i)}(e,i)},imgPreloader.src=o.imageArray[o.activeImage][0]}function r(){d(),s("#lightbox").hide(),s("#overlay").fadeOut(),s("select, object, embed").show()}function m(e){var i=e.data.opts,a=e.keyCode,t=String.fromCharCode(a).toLowerCase();"x"==t||"o"==t||"c"==t||27==a?r():"p"==t||37==a?i.loopImages?(d(),l(0==i.activeImage?i.imageArray.length-1:i.activeImage-1)):0!=i.activeImage&&(d(),l(i.activeImage-1)):"n"!=t&&39!=a||(o.loopImages?(d(),l(i.activeImage==i.imageArray.length-1?0:i.activeImage+1)):i.activeImage!=i.imageArray.length-1&&(d(),l(i.activeImage+1)))}function d(){s(document).unbind("keydown")}},s.fn.lightbox.parseJsonData=function(e){var i=[];return s.each(e,function(){i.push(new Array(this.url,this.title))}),i},s.fn.lightbox.defaults={fileLoadingImage:"scripts/lightbox_assets/images/loading.gif",fileBottomNavCloseImage:"scripts/lightbox_assets/images/closelabel.gif",overlayOpacity:.8,borderSize:10,imageArray:new Array,activeImage:null,inprogress:!1,resizeSpeed:350,widthCurrent:250,heightCurrent:250,xScale:1,yScale:1,displayTitle:!0,navbarOnTop:!1,slideNavBar:!1,navBarSlideSpeed:350,displayHelp:!1,strings:{help:" ‹ / P - previous image    › / N - next image    ESC / X - close image gallery",prevLinkTitle:"previous image",nextLinkTitle:"next image",prevLinkText:"&laquo; Previous",nextLinkText:"Next &raquo;",closeTitle:"close image gallery",image:"Image ",of:" of "},fitToScreen:!1,disableNavbarLinks:!1,loopImages:!1,imageClickClose:!0,jsonData:null,jsonDataParser:null}}(jQuery);
